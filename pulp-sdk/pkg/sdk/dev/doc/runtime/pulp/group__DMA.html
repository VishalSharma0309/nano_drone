<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>DMA management</title>
<title>Runtime: DMA management</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="pulp.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="printComponentTabs.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 46px;">
  <td id="projectlogo"><img alt="Logo" src="Pulp_logo_inline.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Runtime
   &#160;<span id="projectnumber">Version 1.0</span>
   </div>
   <div id="projectbrief">PULP Kernel Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="CMSISnav" class="tabs1">
    <ul class="tablist">
      <script type="text/javascript">
		<!--
		writeComponentTabs.call(this);
		//-->
      </script>
	  </ul>
</div>
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__DMA.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">DMA management<div class="ingroups"><a class="el" href="group__groupCluster.html">Cluster</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga5f80e4995d06e4283e8835ff71577c80"><td class="memItemLeft" align="right" valign="top">typedef struct rt_dma_copy_s&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DMA.html#ga5f80e4995d06e4283e8835ff71577c80">rt_dma_copy_t</a></td></tr>
<tr class="memdesc:ga5f80e4995d06e4283e8835ff71577c80"><td class="mdescLeft">&#160;</td><td class="mdescRight">DMA copy structure.  <a href="#ga5f80e4995d06e4283e8835ff71577c80">More...</a><br /></td></tr>
<tr class="separator:ga5f80e4995d06e4283e8835ff71577c80"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga301134211274df9a4d867a9956ea8d3d"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DMA.html#ga301134211274df9a4d867a9956ea8d3d">rt_dma_dir_e</a> <tr class="memdesc:ga301134211274df9a4d867a9956ea8d3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">DMA transfer direction.  <a href="group__DMA.html#ga301134211274df9a4d867a9956ea8d3d">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:ga301134211274df9a4d867a9956ea8d3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga5ebccef75610c348959c3349d8e874bf"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DMA.html#ga5ebccef75610c348959c3349d8e874bf">rt_dma_memcpy</a> (unsigned int ext, unsigned int loc, unsigned short size, <a class="el" href="group__DMA.html#ga301134211274df9a4d867a9956ea8d3d">rt_dma_dir_e</a> dir, int merge, <a class="el" href="gap8__emul_8h.html#a8c0261c27b9253bf59fcd32be36e17b1">rt_dma_copy_t</a> *copy)</td></tr>
<tr class="memdesc:ga5ebccef75610c348959c3349d8e874bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">1D DMA memory transfer.  <a href="#ga5ebccef75610c348959c3349d8e874bf">More...</a><br /></td></tr>
<tr class="separator:ga5ebccef75610c348959c3349d8e874bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga584ea390f72f41d3d8ea495f65f8d940"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DMA.html#ga584ea390f72f41d3d8ea495f65f8d940">rt_dma_memcpy_2d</a> (unsigned int ext, unsigned int loc, unsigned short size, unsigned short stride, unsigned short length, <a class="el" href="group__DMA.html#ga301134211274df9a4d867a9956ea8d3d">rt_dma_dir_e</a> dir, int merge, <a class="el" href="gap8__emul_8h.html#a8c0261c27b9253bf59fcd32be36e17b1">rt_dma_copy_t</a> *copy)</td></tr>
<tr class="memdesc:ga584ea390f72f41d3d8ea495f65f8d940"><td class="mdescLeft">&#160;</td><td class="mdescRight">2D DMA memory transfer.  <a href="#ga584ea390f72f41d3d8ea495f65f8d940">More...</a><br /></td></tr>
<tr class="separator:ga584ea390f72f41d3d8ea495f65f8d940"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga865b61273daa63c02ba38df236fadf8e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DMA.html#ga865b61273daa63c02ba38df236fadf8e">rt_dma_flush</a> ()</td></tr>
<tr class="memdesc:ga865b61273daa63c02ba38df236fadf8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simple DMA transfer completion flush.  <a href="#ga865b61273daa63c02ba38df236fadf8e">More...</a><br /></td></tr>
<tr class="separator:ga865b61273daa63c02ba38df236fadf8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf35378a83fc331ddd7d1ab833a0fd4c3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DMA.html#gaf35378a83fc331ddd7d1ab833a0fd4c3">rt_dma_wait</a> (<a class="el" href="gap8__emul_8h.html#a8c0261c27b9253bf59fcd32be36e17b1">rt_dma_copy_t</a> *copy)</td></tr>
<tr class="memdesc:gaf35378a83fc331ddd7d1ab833a0fd4c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simple DMA transfer completion wait.  <a href="#gaf35378a83fc331ddd7d1ab833a0fd4c3">More...</a><br /></td></tr>
<tr class="separator:gaf35378a83fc331ddd7d1ab833a0fd4c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<p>The cluster has its own local memory for fast access from the cluster cores while the other memories are relatively slow if accessed by the cluster. To keep all the cores available for computation each cluster contains a DMA unit whose role is to asynchronously transfer data between a remote memory and the cluster memory.</p>
<p>The following API can be used to control the DMA in various ways:</p><ul>
<li>Simple completion. This is only usable by a cluster. A set of transfers can be queued together. An identifier is allocated for the first transfer and reused for the following transfers. This identifier can then be used to block the calling core until all transfers are completed.</li>
<li>Event-based completion. This can be used on either the fabric controller or a cluster to enqueue a transfer and get notified on completion via an event on the fabric controller. </li>
</ul>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga5f80e4995d06e4283e8835ff71577c80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5f80e4995d06e4283e8835ff71577c80">&#9670;&nbsp;</a></span>rt_dma_copy_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct rt_dma_copy_s <a class="el" href="gap8__emul_8h.html#a8c0261c27b9253bf59fcd32be36e17b1">rt_dma_copy_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This structure is used by the runtime to manage a DMA copy. It must be instantiated once for each copy and must be kept alive until the copy is finished. It can be instantiated as a normal variable, for example as a global variable, a local one on the stack, or through the memory allocator. </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga301134211274df9a4d867a9956ea8d3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga301134211274df9a4d867a9956ea8d3d">&#9670;&nbsp;</a></span>rt_dma_dir_e</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__DMA.html#ga301134211274df9a4d867a9956ea8d3d">rt_dma_dir_e</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Describes the direction for a DMA transfer. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga301134211274df9a4d867a9956ea8d3da18cd2e2547ef98f23a429f85c3dddf09"></a>RT_DMA_DIR_LOC2EXT&#160;</td><td class="fielddoc"><p>Transfer from cluster memory to external memory. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga301134211274df9a4d867a9956ea8d3da93841f0fc557210d49dbdfd65d67e298"></a>RT_DMA_DIR_EXT2LOC&#160;</td><td class="fielddoc"><p>Transfer from external memory to cluster memory. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga865b61273daa63c02ba38df236fadf8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga865b61273daa63c02ba38df236fadf8e">&#9670;&nbsp;</a></span>rt_dma_flush()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void rt_dma_flush </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This blocks the core until the DMA does not have any pending transfers.</p>
<p>This can only be called on a cluster. </p>

</div>
</div>
<a id="ga5ebccef75610c348959c3349d8e874bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5ebccef75610c348959c3349d8e874bf">&#9670;&nbsp;</a></span>rt_dma_memcpy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void rt_dma_memcpy </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>ext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__DMA.html#ga301134211274df9a4d867a9956ea8d3d">rt_dma_dir_e</a>&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>merge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="gap8__emul_8h.html#a8c0261c27b9253bf59fcd32be36e17b1">rt_dma_copy_t</a> *&#160;</td>
          <td class="paramname"><em>copy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This enqueues a 1D DMA memory transfer (i.e. classic memory copy) with simple completion based on transfer identifier.</p>
<p>This can only be called on a cluster.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ext</td><td>Address in the external memory where to access the data. There is no restriction on memory alignment. </td></tr>
    <tr><td class="paramname">loc</td><td>Address in the cluster memory where to access the data. There is no restriction on memory alignment. </td></tr>
    <tr><td class="paramname">size</td><td>Number of bytes to be transfered. The only restriction is that this size must fit in 16 bits, i.e. must be less than 65536. </td></tr>
    <tr><td class="paramname">dir</td><td>Direction of the transfer. If RT_DMA_DIR_EXT2LOC, the transfer is loading data from external memory and storing to cluster memory. If RT_DMA_DIR_LOC2EXT, it is the opposite. </td></tr>
    <tr><td class="paramname">merge</td><td>If 1, this transfer will be merged with the previous one, i.e. they will share the same transfer identifier. Otherwise a new identifier will be allocated. </td></tr>
    <tr><td class="paramname">copy</td><td>The structure for the copy. This can be used with rt_dma_wait to wait for the completion of this transfer. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga584ea390f72f41d3d8ea495f65f8d940"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga584ea390f72f41d3d8ea495f65f8d940">&#9670;&nbsp;</a></span>rt_dma_memcpy_2d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void rt_dma_memcpy_2d </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>ext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>stride</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__DMA.html#ga301134211274df9a4d867a9956ea8d3d">rt_dma_dir_e</a>&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>merge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="gap8__emul_8h.html#a8c0261c27b9253bf59fcd32be36e17b1">rt_dma_copy_t</a> *&#160;</td>
          <td class="paramname"><em>copy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This enqueues a 2D DMA memory transfer (rectangle area) with simple completion based on transfer identifier.</p>
<p>This can only be called on a cluster.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ext</td><td>Address in the external memory where to access the data. There is no restriction on memory alignment. </td></tr>
    <tr><td class="paramname">loc</td><td>Address in the cluster memory where to access the data. There is no restriction on memory alignment. </td></tr>
    <tr><td class="paramname">size</td><td>Number of bytes to be transfered. The only restriction is that this size must fit in 16 bits, i.e. must be less than 65536. </td></tr>
    <tr><td class="paramname">stride</td><td>2D stride, which is the number of bytes which are added to the beginning of the current line to switch to the next one. Must fit in 16 bits, i.e. must be less than 65536. </td></tr>
    <tr><td class="paramname">length</td><td>2D length, which is the number of transfered bytes after which the DMA will switch to the next line. Must fit in 16 bits, i.e. must be less than 65536. </td></tr>
    <tr><td class="paramname">dir</td><td>Direction of the transfer. If it is RT_DMA_DIR_EXT2LOC, the transfer is loading data from external memory and storing to cluster memory. If RT_DMA_DIR_LOC2EXT, it is the opposite. </td></tr>
    <tr><td class="paramname">merge</td><td>If 1, this transfer will be merged with the previous one, i.e. they will share the same transfer identifier. Otherwise a new identifier will be allocated. </td></tr>
    <tr><td class="paramname">copy</td><td>The structure for the copy. This can be used with rt_dma_wait to wait for the completion of this transfer. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaf35378a83fc331ddd7d1ab833a0fd4c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf35378a83fc331ddd7d1ab833a0fd4c3">&#9670;&nbsp;</a></span>rt_dma_wait()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void rt_dma_wait </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="gap8__emul_8h.html#a8c0261c27b9253bf59fcd32be36e17b1">rt_dma_copy_t</a> *&#160;</td>
          <td class="paramname"><em>copy</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This blocks the core until the specified transfer is finished. The transfer must be described trough the identifier returned by the copy function.</p>
<p>This can only be called on a cluster.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">copy</td><td>The copy structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
	<!--
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 
	-->
	</li>
  </ul>
</div>
</body>
</html>
